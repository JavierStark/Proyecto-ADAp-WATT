<section [ngClass]="vistaActual === 'tickets' ? 'cuenta-page-tickets' : 'cuenta-page-default'" class="cuenta-page relative w-full bg-green-50">
  

  <!-- Filtro verde semitransparente -->
  <div class="absolute inset-0 bg-green-400 opacity-30 z-0"></div>

  <!-- Contenido principal -->
  <div class="relative z-10 pb-[4vh] pt-[20vw] md:pt-[6vw] px-[4vw] flex flex-col items-center justify-center" [ngClass]="vistaActual === 'tickets' ? 'min-h-screen' : 'h-auto'">
    
    <!-- Spinner de carga -->
    <div *ngIf="loadingPerfil" class="flex flex-col items-center justify-center py-[10vh]">
      <div class="loading-spinner animate-spin rounded-full h-[4vw] w-[4vw] border-b-4 border-green-900 mb-[2vh]"></div>
      <p class="loading-text text-green-900 text-[1.2vw] font-bold">Cargando tu perfil...</p>
    </div>

    <!-- Contenido cuando carga -->
    <div *ngIf="!loadingPerfil" class="w-full">

      <!-- MEN√ö PRINCIPAL -->
      <div *ngIf="vistaActual === 'menu'" class="cuenta-menu flex flex-col items-center justify-center gap-[2vh] max-w-[35vw] mx-auto">
        
        <div class="flex flex-col items-center gap-[1vw] mb-[2vh]">
          <h1 class="text-green-900 text-[3vw] font-bold text-center leading-tight">
            Hola, {{ usuario.nombre || (usuario.email ? usuario.email.split('@')[0] : 'Socio') }} üëã
          </h1>
          
          <span *ngIf="isSocio" 
                class="bg-green-100 text-green-700 text-[1vw] md:text-[0.8vw] font-bold px-[1.2vw] py-[0.4vw] rounded-full border border-green-200 shadow-sm uppercase tracking-wide">
            ‚≠ê Socio Activo
          </span>
        </div>


        <!-- Bot√≥n Mis Datos (borde verde, relleno blanco) -->
        <button 
          (click)="cambiarVista('perfil')"
          class="w-full bg-white text-green-700 text-[1.5vw] font-bold py-[1.2vw] px-[2vw] rounded-[1.5vw] border-2 border-green-600 hover:bg-green-50 transition">
          Mis datos
        </button>

        <!-- Bot√≥n Mis Entradas (relleno verde) -->
        <button 
          (click)="cambiarVista('tickets')"
          class="w-full bg-green-600 text-white text-[1.5vw] font-bold py-[1.2vw] px-[2vw] rounded-[1.5vw] hover:bg-green-700 transition">
          Mis entradas
        </button>

        <!-- Bot√≥n Mis Donaciones (relleno verde) -->
        <button 
          (click)="cambiarVista('donaciones')"
          class="w-full bg-green-600 text-white text-[1.5vw] font-bold py-[1.2vw] px-[2vw] rounded-[1.5vw] hover:bg-green-700 transition">
          Mis donaciones
        </button>

        <!-- Bot√≥n Cerrar Sesi√≥n (relleno verde) -->
        <button 
          (click)="onLogout()"
          class="w-full bg-green-600 text-white text-[1.5vw] font-bold py-[1.2vw] px-[2vw] rounded-[1.5vw] hover:bg-green-700 transition">
          Cerrar sesi√≥n
        </button>
      </div>

      <!-- VISTA PERFIL -->
<div *ngIf="vistaActual === 'perfil'" class="cuenta-perfil flex flex-col pt-[2vw] items-center justify-center">
        
        <div class="cuenta-perfil-card bg-white rounded-[4vw] md:rounded-[2vw] shadow-lg p-[6vw] md:p-[3vw] w-[90vw] md:max-w-[70vw]">
          
          <h3 class="text-green-900 text-[5.5vw] md:text-[2.2vw] font-bold mb-[6vw] md:mb-[2.5vw] text-center border-b border-gray-100 pb-[3vw] md:pb-[1vw]">
            Mi informaci√≥n Personal
          </h3>

          <div class="grid grid-cols-1 md:grid-cols-2 gap-[6vw] md:gap-[4vw] mb-[6vw] md:mb-[3vw]">
            
            <div class="bg-gray-50 p-[4vw] md:p-[2vw] rounded-[3vw] md:rounded-[1.5vw]">
              <h3 class="text-green-700 font-bold text-[3.8vw] md:text-[1.2vw] mb-[4vw] md:mb-[1.5vw] uppercase tracking-wide border-b-2 border-green-200 pb-[1vw] md:pb-[0.5vw] inline-block">
                Datos de Usuario
              </h3>
              
              <div class="space-y-[3.5vw] md:space-y-[1.2vw] text-gray-700">
                <div class="flex flex-col">
                  <span class="text-[3vw] md:text-[0.9vw] text-gray-400 font-bold uppercase">Nombre Completo</span>
                  <span class="font-medium text-[3.8vw] md:text-[1.1vw] text-gray-900">
                    {{ usuario.nombre || '-' }} {{ usuario.apellidos || '' }}
                  </span>
                </div>

                <div class="flex flex-col">
                  <span class="text-[3vw] md:text-[0.9vw] text-gray-400 font-bold uppercase">DNI / Identificaci√≥n</span>
                  <span class="font-medium text-[3.8vw] md:text-[1.1vw] text-gray-900">{{ usuario.dni || '-' }}</span>
                </div>

                <div *ngIf="empresa" class="flex flex-col mt-[3.5vw] md:mt-[1.2vw] pt-[3.5vw] md:pt-[1.2vw] border-t border-gray-200">
                  <span class="text-[3vw] md:text-[0.9vw] text-green-600 font-bold uppercase flex items-center gap-[0.5vw]">
                    üè¢ Cuenta de Empresa
                  </span>
                  <span class="font-medium text-[3.8vw] md:text-[1.1vw] text-gray-900">
                    {{ empresa }}
                  </span>
                </div>

                <div class="flex flex-col">
                  <span class="text-[3vw] md:text-[0.9vw] text-gray-400 font-bold uppercase">Correo Electr√≥nico</span>
                  <span class="font-medium text-[3.8vw] md:text-[1.1vw] text-gray-900 break-all">{{ usuario.email || '-' }}</span>
                </div>

                <div class="flex flex-col">
                  <span class="text-[3vw] md:text-[0.9vw] text-gray-400 font-bold uppercase">Tel√©fono</span>
                  <span class="font-medium text-[3.8vw] md:text-[1.1vw] text-gray-900">{{ usuario.telefono || '-' }}</span>
                </div>
              </div>
            </div>

            <div class="bg-gray-50 p-[4vw] md:p-[2vw] rounded-[3vw] md:rounded-[1.5vw]">
              <h3 class="text-green-700 font-bold text-[3.8vw] md:text-[1.2vw] mb-[4vw] md:mb-[1.5vw] uppercase tracking-wide border-b-2 border-green-200 pb-[1vw] md:pb-[0.5vw] inline-block">
                Direcci√≥n Postal
              </h3>

              <div class="space-y-[3.5vw] md:space-y-[1.2vw] text-gray-700">
                <div class="grid grid-cols-3 gap-[2vw] md:gap-[1vw]">
                  <div class="col-span-2 flex flex-col">
                    <span class="text-[3vw] md:text-[0.9vw] text-gray-400 font-bold uppercase">Calle</span>
                    <span class="font-medium text-[3.8vw] md:text-[1.1vw] text-gray-900">{{ usuario.calle || '-' }}</span>
                  </div>
                  <div class="flex flex-col">
                    <span class="text-[3vw] md:text-[0.9vw] text-gray-400 font-bold uppercase">N√∫mero</span>
                    <span class="font-medium text-[3.8vw] md:text-[1.1vw] text-gray-900">{{ usuario.numero || '-' }}</span>
                  </div>
                </div>

                <div class="grid grid-cols-2 gap-[2vw] md:gap-[1vw]">
                  <div class="flex flex-col">
                    <span class="text-[3vw] md:text-[0.9vw] text-gray-400 font-bold uppercase">Piso / Puerta</span>
                    <span class="font-medium text-[3.8vw] md:text-[1.1vw] text-gray-900">{{ usuario.pisoPuerta || '-' }}</span>
                  </div>
                  <div class="flex flex-col">
                    <span class="text-[3vw] md:text-[0.9vw] text-gray-400 font-bold uppercase">CP</span>
                    <span class="font-medium text-[3.8vw] md:text-[1.1vw] text-gray-900">{{ usuario.codigoPostal || '-' }}</span>
                  </div>
                </div>

                <div class="flex flex-col">
                  <span class="text-[3vw] md:text-[0.9vw] text-gray-400 font-bold uppercase">Ciudad y Provincia</span>
                  <span class="font-medium text-[3.8vw] md:text-[1.1vw] text-gray-900">
                    {{ usuario.ciudad || '-' }} <span *ngIf="usuario.provincia">({{ usuario.provincia }})</span>
                  </span>
                </div>

                <div class="flex flex-col">
                  <span class="text-[3vw] md:text-[0.9vw] text-gray-400 font-bold uppercase">Pa√≠s</span>
                  <span class="font-medium text-[3.8vw] md:text-[1.1vw] text-gray-900">{{ usuario.pais || '-' }}</span>
                </div>
              </div>
            </div>

          </div>

          <div class="cuenta-boton-editar flex justify-center pb-[1vw]">
            <button 
              (click)="entrarModoEdicion()"
              class="bg-green-600 text-white text-[1.2vw] font-bold py-[0.8vw] px-[3vw] rounded-full hover:bg-green-700 transition shadow-md hover:shadow-lg transform hover:-translate-y-1">
              Editar mis datos
            </button>
          </div>

          <div *ngIf="modoEdicion" class="cuenta-edicion mt-[2vw] pt-[2vw] border-t-2 border-gray-200">
            <h3 class="text-[1.5vw] font-bold text-gray-800 mb-[1.5vw] text-center">Modificar Informaci√≥n</h3>
            
            <form (ngSubmit)="guardarCambios()" class="grid grid-cols-2 gap-[2vw]">
              
              <div class="space-y-[1vw]">
                <div>
                  <label class="block text-gray-700 font-bold text-[0.9vw] mb-[0.3vw]">Nombre</label>
                  <input [(ngModel)]="usuario.nombre" name="nombre" type="text" class="w-full p-[0.8vw] text-[1vw] border border-gray-300 rounded-[0.5vw] bg-gray-50 focus:outline-none focus:border-green-600 focus:ring-1 focus:ring-green-600">
                </div>
                <div>
                    <label class="block text-gray-700 font-bold text-[0.9vw] mb-[0.3vw]">Apellidos</label>
                    <input [(ngModel)]="usuario.apellidos" name="apellidos" type="text" class="w-full p-[0.8vw] text-[1vw] border border-gray-300 rounded-[0.5vw] bg-gray-50 focus:outline-none focus:border-green-600 focus:ring-1 focus:ring-green-600">
                </div>
                <div>
                  <label class="block text-gray-700 font-bold text-[0.9vw] mb-[0.3vw]">DNI / NIF</label>
                  <input [(ngModel)]="usuario.dni" name="dni" type="text" class="w-full p-[0.8vw] text-[1vw] border border-gray-300 rounded-[0.5vw] bg-gray-50 focus:outline-none focus:border-green-600 focus:ring-1 focus:ring-green-600">
                </div>
                <div>
                  <label class="block text-gray-700 font-bold text-[0.9vw] mb-[0.3vw]">Tel√©fono</label>
                  <input [(ngModel)]="usuario.telefono" name="telefono" type="tel" class="w-full p-[0.8vw] text-[1vw] border border-gray-300 rounded-[0.5vw] bg-gray-50 focus:outline-none focus:border-green-600 focus:ring-1 focus:ring-green-600">
                </div>
              </div>

              <div class="space-y-[1vw]">
                 <div>
                  <label class="block text-gray-700 font-bold text-[0.9vw] mb-[0.3vw]">Calle</label>
                  <input [(ngModel)]="usuario.calle" name="calle" type="text" class="w-full p-[0.8vw] text-[1vw] border border-gray-300 rounded-[0.5vw] bg-gray-50 focus:outline-none focus:border-green-600 focus:ring-1 focus:ring-green-600">
                 </div>
                 
                 <div class="grid grid-cols-2 gap-[1vw]">
                    <div>
                        <label class="block text-gray-700 font-bold text-[0.9vw] mb-[0.3vw]">N√∫mero</label>
                        <input [(ngModel)]="usuario.numero" name="numero" type="text" class="w-full p-[0.8vw] text-[1vw] border border-gray-300 rounded-[0.5vw] bg-gray-50 focus:outline-none focus:border-green-600 focus:ring-1 focus:ring-green-600">
                    </div>
                    <div>
                        <label class="block text-gray-700 font-bold text-[0.9vw] mb-[0.3vw]">Piso/Puerta</label>
                        <input [(ngModel)]="usuario.pisoPuerta" name="pisoPuerta" type="text" class="w-full p-[0.8vw] text-[1vw] border border-gray-300 rounded-[0.5vw] bg-gray-50 focus:outline-none focus:border-green-600 focus:ring-1 focus:ring-green-600">
                    </div>
                 </div>

                 <div class="grid grid-cols-2 gap-[1vw]">
                    <div>
                        <label class="block text-gray-700 font-bold text-[0.9vw] mb-[0.3vw]">C√≥digo Postal</label>
                        <input [(ngModel)]="usuario.codigoPostal" name="codigoPostal" type="text" class="w-full p-[0.8vw] text-[1vw] border border-gray-300 rounded-[0.5vw] bg-gray-50 focus:outline-none focus:border-green-600 focus:ring-1 focus:ring-green-600">
                    </div>
                    <div>
                        <label class="block text-gray-700 font-bold text-[0.9vw] mb-[0.3vw]">Ciudad</label>
                        <input [(ngModel)]="usuario.ciudad" name="ciudad" type="text" class="w-full p-[0.8vw] text-[1vw] border border-gray-300 rounded-[0.5vw] bg-gray-50 focus:outline-none focus:border-green-600 focus:ring-1 focus:ring-green-600">
                    </div>
                 </div>

                 <div class="grid grid-cols-2 gap-[1vw]">
                    <div>
                        <label class="block text-gray-700 font-bold text-[0.9vw] mb-[0.3vw]">Provincia</label>
                        <input [(ngModel)]="usuario.provincia" name="provincia" type="text" class="w-full p-[0.8vw] text-[1vw] border border-gray-300 rounded-[0.5vw] bg-gray-50 focus:outline-none focus:border-green-600 focus:ring-1 focus:ring-green-600">
                    </div>
                    <div>
                        <label class="block text-gray-700 font-bold text-[0.9vw] mb-[0.3vw]">Pa√≠s</label>
                        <input [(ngModel)]="usuario.pais" name="pais" type="text" class="w-full p-[0.8vw] text-[1vw] border border-gray-300 rounded-[0.5vw] bg-gray-50 focus:outline-none focus:border-green-600 focus:ring-1 focus:ring-green-600">
                    </div>
                 </div>
              </div>
              <div class="col-span-2 mt-[2vw] pt-[2vw] border-t border-gray-200">
    
                  <div class="flex items-start gap-[1vw] mb-[1.5vw]">
                      <input 
                          type="checkbox" 
                          id="checkEmpresa"
                          [(ngModel)]="esEmpresa" 
                          name="esEmpresa"
                          [disabled]="empresaYaRegistrada" 
                          class="w-[4vw] h-[4vw] md:w-[1.2vw] md:h-[1.2vw] text-green-600 rounded focus:ring-green-500 border-gray-300 mt-[0.2vw] disabled:opacity-50 disabled:cursor-not-allowed">
                      
                      <div class="flex flex-col">
                          <label for="checkEmpresa" class="text-gray-800 font-bold text-[3.5vw] md:text-[1vw] cursor-pointer" [class.cursor-not-allowed]="empresaYaRegistrada">
                              Soy una empresa / Quiero facturar a nombre de empresa
                          </label>
                          <span *ngIf="empresaYaRegistrada" class="text-gray-500 text-[0.8vw]">
                              (Esta cuenta ya est√° vinculada a una empresa y no se puede revertir)
                          </span>
                      </div>
                  </div>

                  <div *ngIf="esEmpresa" class="animate-fade-in-up bg-green-50 p-[2vw] rounded-[1vw] border border-green-200">
                      
                      <div *ngIf="!empresaYaRegistrada" class="bg-yellow-100 border-l-4 border-yellow-500 text-yellow-800 p-[1vw] mb-[1.5vw] rounded-[0.5vw] flex items-start gap-[0.8vw]">
                          <span class="text-[1.2vw]">‚ö†Ô∏è</span>
                          <div class="text-[0.9vw]">
                              <p class="font-bold">Importante:</p>
                              <p>Al guardar estos datos, tu cuenta pasar√° a ser un <strong>perfil corporativo</strong> de forma permanente. Esta acci√≥n <strong>no se puede revertir</strong>.</p>
                          </div>
                      </div>

                      <label class="block text-green-800 font-bold text-[0.9vw] mb-[0.3vw]">Nombre Empresa</label>
                      <input 
                          [(ngModel)]="empresa" 
                          name="nombreEmpresa" 
                          type="text" 
                          placeholder="Ej: Construcciones S.L."
                          class="w-full p-[0.8vw] text-[1vw] border border-green-300 rounded-[0.5vw] bg-white focus:outline-none focus:border-green-600 focus:ring-1 focus:ring-green-600">
                      <p class="text-gray-500 text-[0.8vw] mt-[0.5vw]">Este nombre aparecer√° en tus certificados y recibos.</p>
                  </div>

              </div>

              <div class="col-span-2 flex gap-[1vw] pt-[1vw] border-t border-gray-100 mt-[1vw]">
                <button type="submit" [disabled]="isLoading" class="flex-1 bg-green-600 text-white text-[1vw] font-bold py-[0.8vw] rounded-[0.5vw] hover:bg-green-700 transition shadow-md">
                  {{ isLoading ? 'Guardando...' : 'Guardar Cambios' }}
                </button>
                <button type="button" (click)="cancelarEdicion()" class="flex-1 bg-white border border-gray-300 text-gray-600 text-[1vw] font-bold py-[0.8vw] rounded-[0.5vw] hover:bg-gray-100 transition">
                  Cancelar
                </button>
              </div>
            </form>
          </div>

          <div class="cuenta-volver flex justify-center mt-[2vw]">
            <button 
              (click)="cambiarVista('menu')"
              class="text-green-700 font-bold hover:underline text-[1vw]">
              ‚Üê Volver al men√∫
            </button>
          </div>
        </div>
      </div>

      <!-- VISTA ENTRADAS -->
      <div *ngIf="vistaActual === 'tickets'" class="cuenta-tickets max-w-[70vw] pt-[3vw] mx-auto min-h-screen">
        <h1 class="tickets-title text-green-900 text-[2.5vw] font-bold mb-[2vh] text-center">Mis Entradas</h1>

        <div class="flex justify-center mb-[2vw]">
          <button 
            (click)="cambiarVista('menu')"
            class="tickets-volver text-green-700 font-bold hover:underline text-[1vw]">
            ‚Üê Volver al men√∫
          </button>
        </div>
        
        <div *ngIf="isLoading" class="flex flex-col items-center justify-center py-[5vw]">
          <div class="tickets-spinner animate-spin rounded-full h-[3vw] w-[3vw] border-b-[0.4vw] border-green-600 mb-[1vw]"></div>
          <p class="tickets-loading-text text-green-800 text-[1vw] font-bold">Buscando tus entradas...</p>
        </div>

        <div *ngIf="!isLoading" class="animate-fade-in">
            
            <div *ngIf="tickets.length === 0" class="text-center text-[1.2vw] text-gray-600 bg-white p-[3vw] rounded-[1.5vw] shadow-lg">
              <p>No has adquirido ninguna entrada a√∫n. ¬°Ap√∫ntate a un evento!</p>
            </div>

            <div *ngIf="tickets.length > 0" class="grid gap-[1.5vw]">
              <div *ngFor="let ticket of tickets" class="ticket-card bg-white p-[2vw] rounded-[1.5vw] shadow-lg border-l-4 border-green-600">
                <div class="flex flex-col gap-[0.4vw]">
                  <div class="flex items-center justify-between gap-[1vw] flex-wrap">
                    <h3 class="ticket-title font-bold text-[1.3vw] text-gray-800">{{ ticket.eventoNombre || 'Evento' }}</h3>
                    <span class="ticket-badge inline-flex items-center gap-[0.5vw] bg-green-100 text-green-800 px-[1.2vw] py-[0.4vw] rounded-full text-[0.9vw] font-bold">
                      {{ ticket.tipoEntrada || 'Entrada' }}
                    </span>
                  </div>

                  <p class="ticket-meta text-gray-600 text-[1vw]">Fecha del evento: {{ ticket.fechaEvento | date:'dd/MM/yyyy' }}</p>
                  <p class="ticket-meta text-gray-600 text-[1vw]">Ubicaci√≥n: {{ ticket.ubicacion || 'Ubicaci√≥n pendiente' }}</p>
                  <p class="ticket-meta text-gray-600 text-[1vw]">Precio pagado: {{ ticket.precioPagado | currency:'EUR' }}</p>

                  <div class="flex items-center justify-between flex-wrap gap-[1vw] mt-[0.6vw]">
                    <span class="ticket-state inline-flex items-center gap-[0.5vw] bg-green-50 text-green-700 px-[1.2vw] py-[0.5vw] rounded-full text-[0.9vw] font-semibold">
                      {{ ticket.estado || 'Activo' }}
                    </span>
                  </div>

                  <a *ngIf="ticket.codigoQrUrl" [href]="ticket.codigoQrUrl" target="_blank"
                    class="ticket-qr text-green-700 text-[0.95vw] font-semibold hover:underline mt-[0.4vw] inline-flex items-center gap-[0.4vw]">
                    Ver QR
                  </a>
                </div>
              </div>
            </div>

        </div>

      </div>

      <!-- VISTA DONACIONES -->
      <div *ngIf="vistaActual === 'donaciones'" class="cuenta-donaciones max-w-[70vw] pt-[4vw] mx-auto">
        
        <h1 class="donaciones-title text-green-900 text-[2.5vw] font-bold mb-[2vh] text-center">Mi Historial Solidario</h1>
        
        <div class="flex justify-center mb-[2vw]">
          <button 
            (click)="cambiarVista('menu')"
            class="donaciones-volver text-green-700 font-bold hover:underline text-[1vw]">
            ‚Üê Volver al men√∫
          </button>
        </div>

        <div *ngIf="isLoading" class="flex flex-col items-center justify-center py-[5vw]">
          <div class="animate-spin rounded-full h-[3vw] w-[3vw] border-b-[0.4vw] border-green-600 mb-[1vw]"></div>
          <p class="text-green-800 text-[1vw] font-bold">Cargando tus donaciones...</p>
        </div>

        <div *ngIf="!isLoading" class="animate-fade-in">

            <div class="donaciones-total-card bg-green-600 text-white p-[2vw] rounded-[1.5vw] shadow-lg mb-[2vw] text-center">
              <p class="text-[1.2vw] font-medium opacity-90">Total Donado</p>
              <p class="text-[3vw] font-bold">{{ totalDonado | currency:'EUR' }}</p>
            </div>

            <div *ngIf="donaciones.length > 0" class="donaciones-cert bg-blue-50 border-2 border-blue-300 rounded-[1.5vw] p-[2vw] mb-[2vw] shadow-md">
              <h1 class="text-[1.3vw] font-bold text-blue-900 mb-[1vw]">üìÑ Descargar Certificado de Donaciones</h1>
              <p class="text-[0.95vw] text-gray-700 mb-[1.5vw]">Obt√©n un certificado fiscal en PDF con tus donaciones anuales</p>
              
              <div class="flex items-center gap-[1.5vw] flex-wrap">
                <div class="flex items-center gap-[0.8vw]">
                  <label for="yearSelect" class="text-[1vw] font-semibold text-gray-800">A√±o:</label>
                  <select 
                    id="yearSelect"
                    [(ngModel)]="yearSeleccionado"
                    class="p-[0.7vw] text-[0.95vw] border-2 border-gray-300 rounded-[0.6vw] bg-white focus:outline-none focus:border-blue-500 font-medium">
                    <option *ngFor="let anio of aniosDisponibles" [value]="anio">{{ anio }}</option>
                  </select>
                </div>

                <button 
                  (click)="descargarCertificado()"
                  [disabled]="descargandoCertificado"
                  class="bg-blue-600 text-white text-[0.95vw] font-bold py-[0.7vw] px-[2vw] rounded-[0.6vw] hover:bg-blue-700 transition disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-[0.5vw]">
                  <span *ngIf="!descargandoCertificado">üì• Descargar PDF</span>
                  <span *ngIf="descargandoCertificado" class="flex items-center gap-[0.5vw]">
                    <span class="animate-spin inline-block w-[1vw] h-[1vw] border-2 border-white border-t-transparent rounded-full"></span>
                    Generando...
                  </span>
                </button>
              </div>

              <div *ngIf="certificadoWarning" class="mt-[1vw] p-[1vw] rounded-[0.8vw] bg-yellow-100 border border-yellow-300 text-yellow-900 text-[0.95vw]">
                ‚ö†Ô∏è {{ certificadoWarning }}
              </div>
            </div>

            <div *ngIf="donaciones.length === 0" class="donaciones-empty text-center text-[1.2vw] text-gray-600 bg-white p-[3vw] rounded-[1.5vw] shadow-lg">
              <p>A√∫n no has realizado donaciones.</p>
            </div>

            <div class="donaciones-table bg-white rounded-[1.5vw] overflow-hidden shadow-lg">
              <table class="w-full text-left">
                <thead class="bg-gray-100 text-gray-700 uppercase text-[0.9vw] font-bold">
                  <tr>
                    <th class="p-[1.5vw]">Fecha</th>
                    <th class="p-[1.5vw]">M√©todo</th>
                    <th class="p-[1.5vw] text-right">Cantidad</th>
                  </tr>
                </thead>
                <tbody class="divide-y divide-gray-100">
                  <tr *ngFor="let donacion of donaciones" class="hover:bg-gray-50">
                    <td class="p-[1.5vw] text-[0.95vw] text-gray-600">{{ donacion.fecha | date:'dd/MM/yyyy' }}</td>
                    <td class="p-[1.5vw] text-[0.95vw] font-medium text-gray-800">{{ donacion.metodoPago || 'Donaci√≥n' }}</td>
                    <td class="p-[1.5vw] text-[0.95vw] text-right font-bold text-green-600">{{ donacion.monto | currency:'EUR' }}</td>
                  </tr>
                </tbody>
              </table>
            </div>

        </div> </div>
    </div>

  </div>
</section>